<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- svn-version: ${svn.version} -->
<html>
  <head>
    <title>Jamon Tutorial - 10. Template Inheritance: Overriding Inherited Methods/Subtemplates
</title>
    <meta name="keywords" content="template,templates,typed,dynamic,text,java,MVC,render,model-view-controller,typesafety,typesafe"></meta>
    <link rel="SHORTCUT ICON" href="/favicon.ico">
    <link rel="StyleSheet" href="../base.css" type="text/css" media="screen" />
  </head>

  <body>

    <div id="logo">
      <h1 id="logo1">Jamon</h1>
      <h3 id="logo2">a typed template engine for Java</h3>
    </div>

    <h3 id="tagline">
      <span class="tagline1">type</span> <span class="tagline2">safe</span> <span class="tagline3">templating</span><br />
    </h3>

    <div class="header" id="header1"><span /></div>
    <div class="header" id="header2"><span /></div>
    <div class="header" id="header3"><span /></div>
    <div class="header" id="header4"><span /></div>

    <div id="nav">
      <ul class="nav">
          <li class="nav"
    >
<a href="../index.html" >Home</a>
</li>

          <li class="nav"
    >
<a href="../Features.html" >Features</a>
</li>

          <li class="nav"
    >
<a href="../News.html" >News</a>
</li>

          <li class="nav"
    >
<a href="../Download.html" >Download</a>
</li>

          <li class="nav"
    >
<a href="../Contact.html" >Contact</a>
</li>

          <li class="nav"
    >
<a href="../About.html" >About</a>
</li>

        </ul>

        <ul class="nav">
          <li class="static">Documentation</li>
          <li class="nav"
    >
<a href="../Overview.html" >Overview</a>
</li>

          <li class="nav"
    id="current">
<a href="../tutorial/TutorialPath.html" >Tutorial</a>
</li>

          <li class="nav"
    >
<a href="../GeneratedTemplates.html" >Generated classes</a>
</li>

          <li class="nav"
    >
<a href="../UserGuide.html" >User's Guide</a>
</li>

          <li class="nav"
    >
<a href="../Ant.html" >Ant integration</a>
</li>

          <li class="nav"
    >
<a href="../Maven.html" >Maven integration</a>
</li>

          <li class="nav"
    >
<a href="../Eclipse.html" >Eclipse plugin</a>
</li>

          <li class="nav"
    >
<a href="../Servlets.html" >Servlet usage</a>
</li>

          <li class="nav"
    >
<a href="../Reference.html" >Reference manual</a>
</li>

          <li class="nav">
           <a href='../javadoc/index.html'>Javadoc</a>
          </li>
        </ul>
      </div>
      <div id="main">
        <div class="tutorialNav">
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample9.html">Previous</a>
  

    </span>
    <span class="tutorialNavContents">
      <a href="TutorialPath.html">Tutorial contents</a>
    </span>
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample11.html">Next</a>
  

    </span>
  </div>


<h2>Jamon Tutorial - 10. Template Inheritance: Overriding Inherited Methods/Subtemplates
</h2>

As explained in the section on
<a href="TutorialSample7.html" class="file"><code>TutorialSample7.html</code></a>, a subtemplate can
either be <em>private</em> or <em>protected</em>. Subtemplates defined
with the <code>&lt;%def <var>subTempName</var>></code> ... <code>&lt;/%def></code> tag are
<em>private</em> and can be accessed <strong>only</strong> within the
template that defined the subtemplate.
<p>

Subtemplates defined with the
<code>&lt;%method <var>subTempName</var>></code> ... <code>&lt;/%method></code>
tag, however, are <em>protected</em> and can be accessed by templates
that inherit from the template with the subtemplate definition.
To invoke a protected subtemplate defined in a parent, a child template
simply invokes it like any other subtemplate
<pre class="template"><& <var>subTempName</var> &></pre>
Usually, however, it is the parent template that invokes the subtemplate,
and the parent makes the template protected so that the child can
override it. For example, the template
<a href="InheritanceParentProtected.jamon" class="file"><code>InheritanceParentProtected.jamon</code></a> declares a <code>title</code> subtemplate
for the expressed purpose of allowing the child template to
override the subtemplate in order to replace the title.

<pre class="jamon">&lt;%abstract&gt;
&lt;%args&gt;
  User2 userAccount;
&lt;/%args&gt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;&lt;&amp; title; name = userAccount.getName() &amp;&gt;&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;%doc&gt; could include a navigation bar here &lt;/%doc&gt;
    &lt;h1&gt;Jamon&lt;/h1&gt;
    &lt;h3&gt;a typed template engine for Java&lt;/h3&gt;
    &lt;hr&gt;
&lt;%if userAccount.isAuthorized()%&gt;
  &lt;&amp; *CHILD &amp;&gt;
&lt;%else&gt;
  &lt;em&gt;Not authorized to view this page.&lt;/em&gt;
&lt;/%if&gt;
    &lt;%doc&gt; could also include a footer here&lt;/%doc&gt;
  &lt;/body&gt;
&lt;/html&gt;

&lt;%method title&gt;
  &lt;%args&gt;
    String name;
  &lt;/%args&gt;
    Jamon News for &lt;% name %&gt;
&lt;/%method&gt;
</pre>


<p>
The template that derives this template would override the <code>title</code>
subtemplate by using the <code>&lt;%override tutorialName></code> ... <code>&lt;/%override></code> tag.

<pre class="template">
<%override tutorialName>
  <%xargs>
    name;
  &lt;/%xargs>
  Jamon Specials for <% name %>
&lt;/%override>
</pre>

Overridden methods take the same arguments as the method they
override, although, as with template inheritance, only those
arguments declared in an <code>&lt;%xargs&gt;</code>
... <code>&lt;/%xargs&gt;</code> block will be visible within
the body of the override. Also, as with template inheritance,
only the names of the arguments are listed within the
<code>&lt;%xargs></code> ... <code>&lt;/%xargs></code> tag,
because the types of the arguments are declared in the parent template's
definition.
<p>
The template <a href="InheritanceChildProtected.jamon" class="file"><code>InheritanceChildProtected.jamon</code></a>, below, extends
<a href="InheritanceParentProtected.jamon" class="file"><code>InheritanceParentProtected.jamon</code></a> and overrides the subtemplate
<code>title</code>. By overriding the <code>title</code> method
<code>InheritanceChildProtected</code> replaces the title that the
parent template generates.

<pre class="jamon">&lt;%extends InheritanceParentProtected&gt;
&lt;%args&gt;
  String special;
&lt;/%args&gt;
&lt;%xargs&gt;
  userAccount;
&lt;/%xargs&gt;

&lt;h2&gt;Weekly Special&lt;/h2&gt;
&lt;% userAccount == null ? "You" : (userAccount.getName() + ", you") %&gt;\
 qualify for the special of the week!
&lt;blink&gt;&lt;% special %&gt;&lt;/blink&gt;

&lt;%override title&gt;
  &lt;%xargs&gt;
    name;
  &lt;/%xargs&gt;
  Jamon Specials for &lt;% name %&gt;
&lt;/%override&gt;
</pre>


<p>The class <a href="User2.java" class="file"><code>User2.java</code></a> takes advantage of the fact that the
<code>InheritanceParentProtected</code> supports inheritance by
delegating the choice of which derived template to invoke to a
separate method and then simply calling the <code>render()</code>
method on the object returned. The top level controller simply has
to provide the output <code>Writer</code> and the
arguments required by the parent template,
<code>InheritanceParentProtected</code>, while the delegated method
selects the actual template instance and provides the arguments
required by that instance.

<pre class="java">import java.io.OutputStreamWriter;

public class User2
{
  private String name;
  private boolean authorized;

  public User2(String p_name, boolean p_authorized) {
    name = p_name;
    authorized = p_authorized;
  }

  public String getName() { return name; }
  public boolean isAuthorized() { return authorized; }

  public static void main(String[] args) throws Exception {
    User2[] users = new User2[2];
    users[0] = new User2("John Public", false);
    users[1] = new User2("John Rockerfeller", true);

    for (int i=0; i&lt;users.length; i++) {
      // call render() on the parent template and provide arguments
      processUser(args.length == 0 ? null : args[0])
        .render(new OutputStreamWriter(System.out), users[i]);
    }
  }

  /** Chooses the correct derived template to invoke and calls
   *  &lt;code&gt;makeParentRenderer()&lt;/code&gt; on that instance.
   *
   *  @param templateName the key name of the template to create
   *  @return the &lt;code&gt;ParentRenderer&lt;/code&gt; of the derived template
   */
  private static InheritanceParentProtected.ParentRenderer
    processUser(String templateName) {
    // the default template, the special of the week
    if (templateName == null || "special".equalsIgnoreCase(templateName))
    {
      return new InheritanceChildProtected()
        .makeParentRenderer("Jamon free this week only!");
    } else {
      // process other derived templates here
      return null;
    }
  }
}
</pre>


The result of executing this class and template is below.

<pre class="tty">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Jamon Specials for John Public
&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Jamon&lt;/h1&gt;
    &lt;h3&gt;a typed template engine for Java&lt;/h3&gt;
    &lt;hr&gt;

  &lt;em&gt;Not authorized to view this page.&lt;/em&gt;

    &lt;/body&gt;
&lt;/html&gt;

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Jamon Specials for John Rockerfeller
&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Jamon&lt;/h1&gt;
    &lt;h3&gt;a typed template engine for Java&lt;/h3&gt;
    &lt;hr&gt;

  &lt;h2&gt;Weekly Special&lt;/h2&gt;
John Rockerfeller, you qualify for the special of the week!
&lt;blink&gt;Jamon free this week only!&lt;/blink&gt;



    &lt;/body&gt;
&lt;/html&gt;

</pre>


<div class="tutorialNav">
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample9.html">Previous</a>
  

    </span>
    <span class="tutorialNavContents">
      <a href="TutorialPath.html">Tutorial contents</a>
    </span>
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample11.html">Next</a>
  

    </span>
  </div>





      </div>

    <div id="logo">
    <h1 id="logo1">Jamon</h1>
    <h3 id="logo2">a typed template engine for Java</h3>
    </div>


  </body>
</html>

