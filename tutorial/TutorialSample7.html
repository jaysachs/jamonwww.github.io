<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- svn-version: ${svn.version} -->
<html>
  <head>
    <title>Jamon Tutorial - 7. Subtemplates: Functional Decomposition of Templates
</title>
    <meta name="keywords" content="template,templates,typed,dynamic,text,java,MVC,render,model-view-controller,typesafety,typesafe"></meta>
    <link rel="SHORTCUT ICON" href="/favicon.ico">
    <link rel="StyleSheet" href="../base.css" type="text/css" media="screen" />
  </head>

  <body>

    <div id="logo">
      <h1 id="logo1">Jamon</h1>
      <h3 id="logo2">a typed template engine for Java</h3>
    </div>

    <h3 id="tagline">
      <span class="tagline1">type</span> <span class="tagline2">safe</span> <span class="tagline3">templating</span><br />
    </h3>

    <div class="header" id="header1"><span /></div>
    <div class="header" id="header2"><span /></div>
    <div class="header" id="header3"><span /></div>
    <div class="header" id="header4"><span /></div>

    <div id="nav">
      <ul class="nav">
          <li class="nav"
    >
<a href="../index.html" >Home</a>
</li>

          <li class="nav"
    >
<a href="../Features.html" >Features</a>
</li>

          <li class="nav"
    >
<a href="../News.html" >News</a>
</li>

          <li class="nav"
    >
<a href="../Download.html" >Download</a>
</li>

          <li class="nav"
    >
<a href="../Contact.html" >Contact</a>
</li>

          <li class="nav"
    >
<a href="../About.html" >About</a>
</li>

        </ul>

        <ul class="nav">
          <li class="static">Documentation</li>
          <li class="nav"
    >
<a href="../Overview.html" >Overview</a>
</li>

          <li class="nav"
    id="current">
<a href="../tutorial/TutorialPath.html" >Tutorial</a>
</li>

          <li class="nav"
    >
<a href="../GeneratedTemplates.html" >Generated classes</a>
</li>

          <li class="nav"
    >
<a href="../UserGuide.html" >User's Guide</a>
</li>

          <li class="nav"
    >
<a href="../Ant.html" >Ant integration</a>
</li>

          <li class="nav"
    >
<a href="../Maven.html" >Maven integration</a>
</li>

          <li class="nav"
    >
<a href="../Eclipse.html" >Eclipse plugin</a>
</li>

          <li class="nav"
    >
<a href="../Servlets.html" >Servlet usage</a>
</li>

          <li class="nav"
    >
<a href="../Reference.html" >Reference manual</a>
</li>

          <li class="nav">
           <a href='../javadoc/index.html'>Javadoc</a>
          </li>
        </ul>
      </div>
      <div id="main">
        <div class="tutorialNav">
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample6.html">Previous</a>
  

    </span>
    <span class="tutorialNavContents">
      <a href="TutorialPath.html">Tutorial contents</a>
    </span>
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample8.html">Next</a>
  

    </span>
  </div>


<h2>Jamon Tutorial - 7. Subtemplates: Functional Decomposition of Templates
</h2>

<p> Jamon templates can define <em>subtemplates</em>. These are
exactly analogous to methods of a class, except that they are written
in Jamon and are called from the main template or other subtemplates
of the main template. Calling a subtemplate will cause it to print its
output to the same output stream as the main template.


<p> There are actually two types of subtemplates: private and
protected. Private subtemplates are described in this
document. Private subtemplates are accessible <em>only</em> from the
template in which they are defined. Protected subtemplates, which are
described in the tutorial section on inheritance, can also be called
from templates that inherit from the main template.

<p>Private subtemplates are declared in a template file with the
<nobr><code>&lt;%def <em>subtemplate-name</em>></code>
... <code>&lt;/%def></code></nobr> tag. Inside this tag, the
subtemplate can declare required and/or optional arguments just as a
top level template can by using the <nobr><code>&lt;%args></code>
... <code>&lt;/%args></code></nobr> tag.

<p> Subtemplates are called just like any other template, however
subtemplates defined with the <nobr><code>&lt;%def
<em>subtemplate-name</em>></code> ... <code>&lt;/%def></code></nobr> tag are
only visible <em>within</em> the template that defined them.
Subtemplates can call themselves as well as other subtemplates in the
same file or other top level templates.

<h3>An Example</h3>
<ol>
  <li>
    The template <a href="SubtemplateTemplate.jamon" class="file"><code>SubtemplateTemplate.jamon</code></a>, shown below, uses two
    subtemplates to help format a table of user account information.
    The top level template builds a table with a row for each entry
    in an array of names provided as an argument to the top level
    template. It calls the subtemplate <code>row</code> to generate
    each row of table data. The subtemplate <code>row</code>
    calls the subtemplate <code>generateLink</code> to compose a
    URL for each user account.

    <pre class="jamon">&lt;%args&gt;
  String[] names;
  String externalLink;
  String cgiParamName = null;
&lt;/%args&gt;

&lt;table&gt;
  &lt;tr&gt;
    &lt;th&gt;Customer Name&lt;/th&gt;
    &lt;th&gt;Account Page&lt;/th&gt;
  &lt;/tr&gt;
&lt;%for String name : names %&gt;
    &lt;%doc&gt;Call a subtemplate to build each row of the table.&lt;/%doc&gt;
    &lt;&amp; row; name = name; link = externalLink; cgiParam = cgiParamName &amp;&gt;
&lt;/%for&gt;

&lt;%doc&gt;A sub-template to construct each row of the table.&lt;/%doc&gt;
&lt;%def row&gt;
  &lt;%args&gt;
    String name;
    String link;
    String cgiParam;
  &lt;/%args&gt;
  &lt;tr&gt;
    &lt;td align="left"&gt; &lt;% name %&gt; &lt;/td&gt;
    &lt;td&gt; &lt;&amp; generateLink; link = link; name = cgiParam;
            value = name &amp;&gt; &lt;/td&gt;
  &lt;/tr&gt;
&lt;/%def&gt;

&lt;%doc&gt;This sub-template builds a URL.&lt;/%doc&gt;
&lt;%def generateLink&gt;
&lt;%args&gt;
    String link;
    String name = null;
    String value;
&lt;/%args&gt;
&lt;%doc&gt; The following emit tags use '#u' to force URL style
escaping for the CGI parameters. (The 'link' should already
be in proper format.)&lt;/%doc&gt;
&lt;a href="&lt;% link %&gt;&lt;% name == null ? "" : "?" + name + "=" + value #u%&gt;"&gt;
  Account information for &lt;% name %&gt; &lt;/a&gt;
&lt;/%def&gt;
</pre>

  </li>

  <li>
    This template is called from the Java class
     <a href="SubtemplateTut7.java" class="file"><code>SubtemplateTut7.java</code></a>:
     <pre class="java">import java.io.OutputStreamWriter;

public class SubtemplateTut7 {
  public static void main(String[] argv) throws Exception {
    // data to pass to the template
    String[] accountNames = new String[] {
      "John Doe", "Mary Jane", "Bonnie Blue", "Johnny Reb" };
    String accountInfoUrl = "http://www.bank.com/accountInfo";
    // call the template ...
    new SubtemplateTemplate()
      .setCgiParamName("username")
      .render(new OutputStreamWriter(System.out),
              accountNames, accountInfoUrl);
  }
}
</pre>

  </li>

  <li>
    Process the template and Java class with the following commands.
    <pre class="tty">
        export CLASSPATH=.:/path/to/jamon-runtime.jar:/path/to/jamon-api.jar:/path/to/jamon-processor.jar
        java org.jamon.TemplateProcessor --destDir=. SubtemplateTemplate
        javac SubtemplateTut7.java SubtemplateTemplate*.java
        java SubtemplateTut7
    </pre>
  </li>

  <li>
    The output should be
    <pre class="tty">
&lt;table&gt;
  &lt;tr&gt;
    &lt;th&gt;Customer Name&lt;/th&gt;
    &lt;th&gt;Account Page&lt;/th&gt;
  &lt;/tr&gt;

    &lt;tr&gt;
    &lt;td align="left"&gt; John Doe &lt;/td&gt;
    &lt;td&gt; &lt;a href="http://www.bank.com/accountInfo%3Fusername%3DJohn+Doe"&gt;
  Account information for username &lt;/a&gt;
 &lt;/td&gt;
  &lt;/tr&gt;


    &lt;tr&gt;
    &lt;td align="left"&gt; Mary Jane &lt;/td&gt;
    &lt;td&gt; &lt;a href="http://www.bank.com/accountInfo%3Fusername%3DMary+Jane"&gt;
  Account information for username &lt;/a&gt;
 &lt;/td&gt;
  &lt;/tr&gt;


    &lt;tr&gt;
    &lt;td align="left"&gt; Bonnie Blue &lt;/td&gt;
    &lt;td&gt; &lt;a href="http://www.bank.com/accountInfo%3Fusername%3DBonnie+Blue"&gt;
  Account information for username &lt;/a&gt;
 &lt;/td&gt;
  &lt;/tr&gt;


    &lt;tr&gt;
    &lt;td align="left"&gt; Johnny Reb &lt;/td&gt;
    &lt;td&gt; &lt;a href="http://www.bank.com/accountInfo%3Fusername%3DJohnny+Reb"&gt;
  Account information for username &lt;/a&gt;
 &lt;/td&gt;
  &lt;/tr&gt;



</pre>

  </li>
</ol>
<p>

<div class="tutorialNav">
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample6.html">Previous</a>
  

    </span>
    <span class="tutorialNavContents">
      <a href="TutorialPath.html">Tutorial contents</a>
    </span>
    <span class="tutorialNavNeighbor">
      
    <a href="TutorialSample8.html">Next</a>
  

    </span>
  </div>





      </div>

    <div id="logo">
    <h1 id="logo1">Jamon</h1>
    <h3 id="logo2">a typed template engine for Java</h3>
    </div>


  </body>
</html>

